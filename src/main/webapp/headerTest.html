<!doctype html>
<!--suppress ALL -->
<html lang="zh-Hant">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>導覽列</title>
    <!--bootstrap5-->
    <link rel="stylesheet" href="/TwoClothing/css/bootstrap5/bootstrap.min.css">
    <!--google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
    <style>
        *:not([class^="fa-"]) {
            font-family: 'Noto Sans TC', sans-serif !important;
        }
    </style>
    <!--Font Awesome-->
    <script src="https://kit.fontawesome.com/716afdf889.js" crossorigin="anonymous"></script>

    <style>

        header {
            background-color: #fff8fb;
        }

        header .linkText, header .linkIcon {
            color: #561729;
            cursor: pointer;
        }

        header .linkText:hover, header .linkIcon:hover {
            color: #00302e;
        }

        header .titleName {
            color: #561729;
        }

        header .navbar-brand {
            transition: transform 0.3s;
        }

        header .navbar-brand:hover {
            transform: scale(1.2);
            z-index: 1000;
        }


        /*scrollbar*/
        body {
            margin-top: 92px;
            --sb-track-color: #76d3d3;
            --sb-thumb-color: #117f7c;
            --sb-size: 10px;

            scrollbar-color: var(--sb-thumb-color) var(--sb-track-color);
        }

        body::-webkit-scrollbar {
            width: var(--sb-size)
        }

        body::-webkit-scrollbar-track {
            background: var(--sb-track-color);
            border-radius: 3px;
        }

        body::-webkit-scrollbar-thumb {
            background: var(--sb-thumb-color);
            border-radius: 3px;

        }

        /*視窗進度條*/
        #scroll-progress {
            height: 3px;
            background-color: #117f7c;
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            z-index: 9999;
            transition: width 0.1s;
        }

        /*搜尋框*/
        header .searchBox {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            background: #2f3640;
            border-radius: 50px;
            position: relative;
        }

        header .searchButton {
            color: white;
            position: absolute;
            right: 8px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-2, linear-gradient(90deg, #2AF598 0%, #009EFD 100%));
            border: 0;
            display: inline-block;
            transition: all 300ms cubic-bezier(.23, 1, 0.32, 1);
        }

        header .searchButton:hover {
            color: #fff;
            background-color: #1A1A1A;
            box-shadow: rgba(0, 0, 0, 0.5) 0 10px 20px;
            transform: translateY(-3px);
        }

        header .searchButton:active {
            box-shadow: none;
            transform: translateY(0);
        }

        header .searchInput {
            border: none;
            background: none;
            outline: none;
            color: white;
            font-size: 15px;
            padding: 24px 46px 24px 26px;
            width: 350px;
            height: 60px;
        }

        /*搜尋框*/

        /*漢堡按鈕*/

        header .menu {
            background-color: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            padding: 0;
        }

        header .line {
            fill: none;
            stroke: black;
            stroke-width: 6;
            transition: stroke-dasharray 600ms cubic-bezier(0.4, 0, 0.2, 1),
            stroke-dashoffset 600ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        header .line1 {
            stroke-dasharray: 60 207;
            stroke-width: 6;
        }

        header .line2 {
            stroke-dasharray: 60 60;
            stroke-width: 6;
        }

        header .line3 {
            stroke-dasharray: 60 207;
            stroke-width: 6;
        }

        header .opened .line1 {
            stroke-dasharray: 90 207;
            stroke-dashoffset: -134;
            stroke-width: 6;
        }

        header .opened .line2 {
            stroke-dasharray: 1 60;
            stroke-dashoffset: -30;
            stroke-width: 6;
        }

        header .opened .line3 {
            stroke-dasharray: 90 207;
            stroke-dashoffset: -134;
            stroke-width: 6;
        }

        /*漢堡按鈕*/

        header a {
            font-size: 14px;
            font-weight: 700
        }

        header .superNav {
            font-size: 13px;
        }

        header .form-control {
            outline: none !important;
            box-shadow: none !important;
        }

        /*RWD*/
        @media screen and (max-width: 540px) {
            .centerOnMobile {
                text-align: center
            }
        }

        @media screen and (max-width: 1399.2px) and (min-width: 991.2px) {
            .linkText {
                display: none;
            }

            .linkIcon {
                font-size: 20px;
            }
        }

        @media screen and (max-width: 991.2px) {
            body {
                margin-top: 124px;
            }
        }

        @media screen and (max-width: 767.2px) {
            body {
                margin-top: 184px;
            }
        }

        /* 選項下拉式選單 */
        header .nav-item .dropdown-menu {
            display: none;
            position: absolute;
            z-index: 1000;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header .dropdown-menu {
            width: auto;
            min-width: 200px;
        }


        header .nav-item:hover .dropdown-menu {
            display: block;
        }


        header .dropdown-item {
            font-size: 14px;
            display: block;
            padding: 8px;
            color: #000000;
            text-decoration: none;
        }

        header .dropdown-item:hover {
            background-color: #f8f9fa;
        }


    </style>
</head>
<body>

<header class="fixed-top">
    <!-- 頁面進度條 -->
    <div id="scroll-progress"></div>
    <div class="needSlide">
        <nav class="navbar navbar-expand-lg bg-white sticky-top navbar-light p-3 shadow-sm">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <img src="images/Mainicon.png" style="height: 50px">
                    <strong class="titleName">TwoClothing</strong>
                </a>
                <!--漢堡選單按鈕-->
                <button class="navbar-toggler menu"
                        data-bs-toggle="collapse"
                        data-bs-target="#navbarNavDropdown"
                        onclick="this.classList.toggle('opened');this.setAttribute('aria-expanded', this.classList.contains('opened'))"
                        aria-label="Main Menu">
                    <svg width="50" height="50" viewBox="0 0 100 100">
                        <path class="line line1"
                              d="M 20,29.000046 H 80.000231 C 80.000231,29.000046 94.498839,28.817352 94.532987,66.711331 94.543142,77.980673 90.966081,81.670246 85.259173,81.668997 79.552261,81.667751 75.000211,74.999942 75.000211,74.999942 L 25.000021,25.000058"/>
                        <path class="line line2" d="M 20,50 H 80"/>
                        <path class="line line3"
                              d="M 20,70.999954 H 80.000231 C 80.000231,70.999954 94.498839,71.182648 94.532987,33.288669 94.543142,22.019327 90.966081,18.329754 85.259173,18.331003 79.552261,18.332249 75.000211,25.000058 75.000211,25.000058 L 25.000021,74.999942"/>
                    </svg>
                </button>
                <!--漢堡選單按鈕-->
                <div class="mx-auto my-3 d-lg-none d-sm-block d-xs-block">
                    <!--SearchBar視窗縮小時-->
                    <div class="searchBox">
                        <input class="searchInput" type="text" name="keyword" placeholder="關鍵字搜尋...">
                        <button class="searchButton" href="#">
                            <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29"
                                 fill="none">
                                <g clip-path="url(#clip0_2_17)">
                                    <g filter="url(#filter0_d_2_17)">
                                        <path d="M23.7953 23.9182L19.0585 19.1814M19.0585 19.1814C19.8188 18.4211 20.4219 17.5185 20.8333 16.5251C21.2448 15.5318 21.4566 14.4671 21.4566 13.3919C21.4566 12.3167 21.2448 11.252 20.8333 10.2587C20.4219 9.2653 19.8188 8.36271 19.0585 7.60242C18.2982 6.84214 17.3956 6.23905 16.4022 5.82759C15.4089 5.41612 14.3442 5.20435 13.269 5.20435C12.1938 5.20435 11.1291 5.41612 10.1358 5.82759C9.1424 6.23905 8.23981 6.84214 7.47953 7.60242C5.94407 9.13789 5.08145 11.2204 5.08145 13.3919C5.08145 15.5634 5.94407 17.6459 7.47953 19.1814C9.01499 20.7168 11.0975 21.5794 13.269 21.5794C15.4405 21.5794 17.523 20.7168 19.0585 19.1814Z"
                                              stroke="white" stroke-width="3" stroke-linecap="round"
                                              stroke-linejoin="round" shape-rendering="crispEdges"></path>
                                    </g>
                                </g>
                                <defs>
                                    <filter id="filter0_d_2_17" x="-0.418549" y="3.70435" width="29.7139"
                                            height="29.7139" filterUnits="userSpaceOnUse"
                                            color-interpolation-filters="sRGB">
                                        <feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood>
                                        <feColorMatrix in="SourceAlpha" type="matrix"
                                                       values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                                                       result="hardAlpha"></feColorMatrix>
                                        <feOffset dy="4"></feOffset>
                                        <feGaussianBlur stdDeviation="2"></feGaussianBlur>
                                        <feComposite in2="hardAlpha" operator="out"></feComposite>
                                        <feColorMatrix type="matrix"
                                                       values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"></feColorMatrix>
                                        <feBlend mode="normal" in2="BackgroundImageFix"
                                                 result="effect1_dropShadow_2_17"></feBlend>
                                        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_17"
                                                 result="shape"></feBlend>
                                    </filter>
                                    <clipPath id="clip0_2_17">
                                        <rect width="28.0702" height="28.0702" fill="white"
                                              transform="translate(0.403503 0.526367)"></rect>
                                    </clipPath>
                                </defs>
                            </svg>
                        </button>
                    </div>
                    <!--SearchBar視窗縮小時-->
                </div>
                <div class="collapse navbar-collapse" id="navbarNavDropdown">
                    <div class="ms-auto d-none d-lg-block">
                        <!--SearchBar-->
                        <div class="searchBox">
                            <input class="searchInput" type="text" name="keyword" placeholder="關鍵字搜尋...">
                            <button class="searchButton" href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29"
                                     fill="none">
                                    <g clip-path="url(#clip0_2_17)">
                                        <g filter="url(#filter0_d_2_17)">
                                            <path d="M23.7953 23.9182L19.0585 19.1814M19.0585 19.1814C19.8188 18.4211 20.4219 17.5185 20.8333 16.5251C21.2448 15.5318 21.4566 14.4671 21.4566 13.3919C21.4566 12.3167 21.2448 11.252 20.8333 10.2587C20.4219 9.2653 19.8188 8.36271 19.0585 7.60242C18.2982 6.84214 17.3956 6.23905 16.4022 5.82759C15.4089 5.41612 14.3442 5.20435 13.269 5.20435C12.1938 5.20435 11.1291 5.41612 10.1358 5.82759C9.1424 6.23905 8.23981 6.84214 7.47953 7.60242C5.94407 9.13789 5.08145 11.2204 5.08145 13.3919C5.08145 15.5634 5.94407 17.6459 7.47953 19.1814C9.01499 20.7168 11.0975 21.5794 13.269 21.5794C15.4405 21.5794 17.523 20.7168 19.0585 19.1814Z"
                                                  stroke="white" stroke-width="3" stroke-linecap="round"
                                                  stroke-linejoin="round" shape-rendering="crispEdges"></path>
                                        </g>
                                    </g>
                                    <defs>
                                        <filter id="filter0_d_2_17" x="-0.418549" y="3.70435" width="29.7139"
                                                height="29.7139" filterUnits="userSpaceOnUse"
                                                color-interpolation-filters="sRGB">
                                            <feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood>
                                            <feColorMatrix in="SourceAlpha" type="matrix"
                                                           values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                                                           result="hardAlpha"></feColorMatrix>
                                            <feOffset dy="4"></feOffset>
                                            <feGaussianBlur stdDeviation="2"></feGaussianBlur>
                                            <feComposite in2="hardAlpha" operator="out"></feComposite>
                                            <feColorMatrix type="matrix"
                                                           values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"></feColorMatrix>
                                            <feBlend mode="normal" in2="BackgroundImageFix"
                                                     result="effect1_dropShadow_2_17"></feBlend>
                                            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_17"
                                                     result="shape"></feBlend>
                                        </filter>
                                        <clipPath id="clip0_2_17">
                                            <rect width="28.0702" height="28.0702" fill="white"
                                                  transform="translate(0.403503 0.526367)"></rect>
                                        </clipPath>
                                    </defs>
                                </svg>
                            </button>
                        </div>
                        <!--SearchBar-->
                    </div>

                    <ul class="navbar-nav ms-auto ">
                        <li class="nav-item">
                            <a class="nav-link mx-2">
                                <i class="fa-solid fa-circle-user linkIcon">
                                    <span class="linkText HeadMbrStatus">會員中心</span>
                                </i>
                            </a>
                            <div class="dropdown-menu text-center HeadMemberDrop">
                                <div class="member-profile">
                                    <img src="" alt="你的大頭貼" class="avatar"
                                         style="height: 50px; width: 50px ;border-radius: 50%; object-fit:cover">
                                    <span class="HeadMbrAccount">會員帳號</span>
                                </div>
                                <hr class="dropdown-divider">
                                <a class="dropdown-item" href="#">錢包餘額：<span class="HeadBalance"></span></a>
                                <a class="dropdown-item" href="#">點數餘額：<span class="HeadMbrPoint"></span></a>
                                <div>
                                    <hr class="dropdown-divider">
                                </div>
                                <a class="dropdown-item" href="#">會員中心</a>
                                <a class="dropdown-item" href="#">訂單查詢</a>
                                <a class="dropdown-item" href="#">我的收藏</a>
                                <a class="dropdown-item" href="#">競標中</a>
                                <div>
                                    <hr class="dropdown-divider">
                                </div>
                                <form action="/TwoClothing/members/Members.do" method="post">
                                    <input type="hidden" name="action" value="logout">
                                    <button class="dropdown-item" type="submit">登出</button>
                                </form>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2 shoppingCar position-relative">
                                <span class="position-absolute top-0 start-75 translate-middle badge rounded-pill bg-danger carNum">
                                </span>
                                <i class="fa-solid fa-cart-shopping linkIcon">
                                    <span class="linkText">購物車</span>
                                </i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2 notice position-relative">
                                <span class="position-absolute top-0 start-75 translate-middle badge rounded-pill bg-danger noticeNum">
                                </span>
                                <i class="fa-solid fa-bell linkIcon">
                                    <span class="linkText">系統通知</span>
                                </i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">
                                <i class="fa-solid fa-shirt linkIcon">
                                    <span class="linkText">商品</span>
                                </i>

                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">
                                <i class="fa-solid fa-sack-dollar linkIcon">
                                    <span class="linkText">賣東西</span>
                                </i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">
                                <i class="fa-solid fa-scale-balanced linkIcon">
                                    <span class="linkText">競標專區</span>
                                </i>

                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="/TwoClothing/front/chatroom/0.check">
                                <i class="fa-solid fa-comments linkIcon">
                                    <span class="linkText">即時通</span>
                                </i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</header>


<div class="container-fluid" style="height: 9000px; background-color: #e1c1c1;">
    <a href="#">123</a>>
</div>


<!--bootstrap5-->
<script src="/TwoClothing/js/bootstrap5/popper.min.js"></script>
<script src="/TwoClothing/js/bootstrap5/bootstrap.min.js"></script>
<!--jQuery-->
<script src="/TwoClothing/js/jQuery/jquery-3.7.1.min.js"></script>
<!--sweetalert-->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<script>
    // 頁面動畫
    $(document).ready(function () {
        // 頁面進度條
        $(document).scroll(function () {
            const scrollHeight = $(document).height() - $(window).height();
            const scrollTop = $(window).scrollTop();
            const scrollProgress = (scrollTop / scrollHeight) * 100;
            $("#scroll-progress").css("width", scrollProgress + "%");
        });
        // 按鈕動畫(滑鼠移入移出)
        const nav_item = $(".nav-item");


        nav_item.mouseenter(function () {
            $(this).find(".linkIcon").addClass("fa-bounce");
        })

        nav_item.mouseleave(function () {
            $(this).find(".linkIcon").removeClass("fa-bounce");
        })

        // 視窗滾動決定導覽列收縮
        let prevScrollPos = $(window).scrollTop();
        const scrollPositionThreshold = 400;
        let isNavCollapsed = false;

        $(window).scroll(function () {
            let currentScrollPos = $(window).scrollTop();
            if (prevScrollPos < currentScrollPos && currentScrollPos > scrollPositionThreshold) {
                if (!isNavCollapsed) {
                    isNavCollapsed = true;
                    $("header .needSlide").slideUp(300);
                }
            } else {
                if (isNavCollapsed) {
                    isNavCollapsed = false;
                    $("header .needSlide").slideDown(300);
                }
            }
            prevScrollPos = currentScrollPos;
        });

        // 確保兩個搜尋框的輸入永遠相同
        const searchInput = $(".searchInput");
        searchInput.on("input", function () {
            let value = $(this).val();
            searchInput.val(value);
        })

    });

    // 頁面Ajax
    $(document).ready(function () {
        confirmLogin();
    })

    // 防止上一頁下一頁緩存 (pageshow = 頁面導航事件)
    $(window).on("pageshow", function (event) {
        if (event.originalEvent.persisted) {
            confirmLogin();
        }
    });

    // 確認是否有登入
    function confirmLogin() {
        const mbrStatus = $(".HeadMbrStatus");
        const mbrStatus_A = mbrStatus.closest("a");
        const memberDrop = $(".HeadMemberDrop");
        // 判斷有沒有登入,動態改變會員下拉式選單的內容
        // jQuery Ajax Get request
        $.post('/TwoClothing/headerHelper/loginValidate', function (data) {
            if (!data.isLogin) {
                // 沒有登入
                memberDrop.remove();
                mbrStatus.text(data.mbrStatus)
                mbrStatus_A.attr("href", "/TwoClothing/front_end/members/registerLogin.jsp")
                // 沒登入移除緩存資料
                notLogin();
                return;
            }
            if (data.isLogin) {
                // 有登入
                const mbrPoint = $(".HeadMbrPoint");
                const balance = $(".HeadBalance");
                const mbrAccount = $(".HeadMbrAccount");
                const avatar = $(".avatar");
                mbrStatus.text(data.mbrStatus);
                mbrPoint.text(data.mbrPoint);
                balance.text(formatToMoney(data.balance));
                mbrAccount.text(data.mbrAccount);
                avatar.attr("src", "/TwoClothing/DBGifReader5?mbrid=" + data.mbrId + "&imgType=avatar");
                // 有登入才去抓其他資料
                alreadyLogin(data.mbrId);
                return;
            }
        })
    }

    // 登入後Ajax請求會員資料
    function alreadyLogin(mbrId) {
        // 購物車相關節點
        const shoppingCar_A = $(".shoppingCar");
        shoppingCar_A.attr("href", "/TwoClothing/ItemCart/cartlist?goto=cart&mbrId=" + mbrId);
        const carNum_Span = $(".carNum");
        // 系統通知相關節點
        const notice_A = $(".notice");
        notice_A.attr("href", "/TwoClothing/ItemCart/cartlist?goto=cart&mbrId=" + mbrId);
        const noticeNum_Span = $(".noticeNum");
        //
        $.post("/TwoClothing/headerHelper/search", function (data) {
            // 購物車數量
            if (data.carNum > 0) {
                carNum_Span.text(data.carNum);
                carNum_Span.show();
            } else {
                carNum_Span.text("");
                carNum_Span.hide();
            }
            // 系統通知數量
        });
    }

    // 移除緩存資料
    function notLogin() {
        // 購物車連結與數量
        const shoppingCar_A = $(".shoppingCar");
        const carNum_Span = $(".carNum");
        shoppingCar_A.removeAttr("href");
        carNum_Span.text("");
        carNum_Span.hide();
    }

    // 數字轉 $xxx,xxx,xxx
    function formatToMoney(number) {
        const formatter = new Intl.NumberFormat('zh-TW', {
            maximumFractionDigits: 0,
        });
        return '$' + formatter.format(number);
    }
</script>

</body>
</html>
<!doctype html>
<html lang="zh-hant" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æ–°å¢ç«¶æ¨™å•†å“</title>
    <!--bootstrap5 css-->
    <link rel="stylesheet" href="/TwoClothing/css/bootstrap5/bootstrap.min.css">
    <!-- google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500&display=swap" rel="stylesheet">
    <style>

        ul, ul li {
            list-style: none;
        }

        ul {
            margin-top: 10px;
        }

        .selectable::before {
            content: "ğŸŒŸ";
            padding-right: 5px;
        }

        .selectable:hover::before, .selectable:hover {
            content: "ğŸ”¯";
            cursor: pointer;
        }

        .non-selectable::before {
            content: "ğŸ¢‚";
            padding-right: 5px;
            color: #561729;
        }

        .non-selectable:hover::before, .non-selectable:hover {
            content: "ğŸ¢†";
            padding-right: 0;
            cursor: not-allowed;
        }

        .modal-content {
            background-color: rgb(249, 237, 242);
            color: #00302e;
        }

        .fixed-button {
            position: sticky;
            bottom: 20px;
            right: 10px;
            float: right;
            z-index: 1000;
        }

        .text-danger {
            margin-left: 5px;
            font-size: 20px;
        }

    </style>
</head>

<body style="background-color:#fff8fb">

<div class="container">
    <div class="row justify-content-center my-5">
        <div class="col-12">
            <form action="/TwoClothing/servlet/front/biditem" method="post" enctype="multipart/form-data">

                <div class="mb-4 border p-4 rounded-3" style="background-color:white">
                    <h2 class="mb-4">å•†å“è³‡è¨Š</h2>
                    <div class="mb-3">
                        <label for="bidname" class="form-label">å•†å“æ¨™é¡Œ<span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="bidname" aria-describedby="bidnameHelp"
                               name="bidname" required maxlength="40">
                        <div id="bidnameHelp" class="form-text">ç²¾å¿ƒæŒ‘é¸æ¨™é¡Œï¼Œæå‡æ‚¨çš„å•†å“æ›å…‰ç‡(æœ€å¤§å­—æ•¸40)</div>
                    </div>

                    <div class="mb-3">
                        <label for="categorySelect" class="form-label">å•†å“é¡åˆ¥æ¨™ç±¤<span
                                class="text-danger">*</span></label>
                        <!-- é¡¯ç¤ºé¸æ“‡çš„å®Œæ•´çµæ§‹,ä½†ä¸å¾€å¾Œå‚³ -->
                        <input type="text" class="form-control" id="categorySelect"
                               aria-describedby="categorySelectHelp" readonly>
                        <!--å„²å­˜æ¨™ç±¤çš„idå‚³çµ¦å¾Œç«¯-->
                        <input type="hidden" id="selectedCategoryId" name="tagId">
                        <div id="categorySelectHelp" class="form-text">é¸æ“‡é©ç•¶çš„æ¨™ç±¤ï¼Œè®“æ›´å¤šäººèƒ½æ‰¾åˆ°æ‚¨çš„å•†å“</div>
                    </div>
                    <div class="modal fade" id="categoryModal" tabindex="-1" role="dialog"
                         aria-labelledby="categoryModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="categoryModalLabel">é¸æ“‡å•†å“é¡åˆ¥æ¨™ç±¤</h5>
                                </div>
                                <div class="modal-body" id="categoryTree">
                                    <!-- é¡åˆ¥æ¨™ç±¤æ¨¹ç‹€çµæ§‹åœ¨é€™è£¡ç”Ÿæˆ -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="grade" class="form-label">å•†å“æ–°èˆŠç¨‹åº¦<span class="text-danger">*</span></label>
                        <select class="form-select" id="grade" aria-describedby="gradeHelp" name="grade" required>
                            <option value="" selected>è«‹é¸æ“‡å•†å“æ–°èˆŠç¨‹åº¦</option>
                            <option value="0">å…¨æ–°(æ²’ä½¿ç”¨éä¸”åŒ…è£æœªæ‹†,åŠç‰Œæœªå‰ª)</option>
                            <option value="1">9æˆ5æ–°(æ²’æœ‰ä½¿ç”¨ç—•è·¡,ä½†åŒ…è£å·²æ‹†,åŠç‰Œå·²å‰ª)</option>
                            <option value="2">9æˆæ–°(æœ‰ä½¿ç”¨ç—•è·¡,ä½†æ²’æœ‰ç‘•ç–µ)</option>
                            <option value="3">8æˆæ–°(æœ‰ä½¿ç”¨ç—•è·¡,å°‘é‡ç‘•ç–µ)</option>
                            <option value="4">5æˆæ–°(æœ‰ä½¿ç”¨ç—•è·¡,æ˜é¡¯ç‘•ç–µ)</option>
                            <option value="5">ç ´æå•†å“(éœ€è¦ä¿®è£œ)</option>
                        </select>
                        <div id="gradeHelp" class="form-text">è«‹ä¾é¸é …èªªæ˜é¸æ“‡å•†å“æ–°èˆŠæˆåº¦</div>
                    </div>

                    <div class="mb-3">
                        <label for="size" class="form-label">å•†å“å°ºå¯¸</label>
                        <select class="form-select" id="size" name="size">
                            <option value="9" selected>å¦‚æœæ‚¨çš„å•†å“ä¸æ˜¯ä»¥ä¸‹åˆ—é¸é …ä¾†æè¿°å°ºå¯¸ï¼Œè«‹è·³éæ­¤é¸æ“‡</option>
                            <option value="0">XS(å«)ä»¥ä¸‹</option>
                            <option value="1">S</option>
                            <option value="2">M</option>
                            <option value="3">L</option>
                            <option value="4">XL</option>
                            <option value="5">2XL</option>
                            <option value="6">3XL</option>
                            <option value="7">4XL(å«)ä»¥ä¸Š</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="detail" class="form-label">å•†å“ç°¡è¿°</label>
                        <textarea class="form-control" id="detail" aria-describedby="detailHelp"
                                  name="detail" maxlength="100" rows="5"></textarea>
                        <div id="detailHelp" class="form-text">æ¸…æ¥šçš„æè¿°å•†å“å°ºå¯¸ï¼Œå”åŠ©è²·å®¶åšå‡ºé¸æ“‡</div>
                    </div>

                    <div class="mb-3">
                        <label for="image01" class="form-label">ä¸Šå‚³å•†å“çš„ä¸»åœ–ç‰‡<span
                                class="text-danger">*</span></label>
                        <input class="form-control" type="file" id="image01" name="image01"
                               accept="image/jpeg, image/png" required aria-describedby="image01Help">
                        <div id="image01Help" class="form-text">è«‹è‡³å°‘é¸æ“‡ä¸€å¼µå•†å“åœ–ç‰‡</div>
                    </div>

                    <div class="mb-3">
                        <label for="image02" class="form-label">ä¸Šå‚³å•†å“çš„è£œå……åœ–ç‰‡</label>
                        <input class="form-control" type="file" id="image02" name="image02"
                               accept="image/jpeg, image/png">
                    </div>

                </div>

                <div class="mb-4 border p-4 rounded-3" style="background-color:white">
                    <h2 class="mb-4">éŠ·å”®è³‡è¨Š</h2>
                    <div class="mb-3">
                        <label for="startprice" class="form-labe">èµ·æ¨™åƒ¹æ ¼<span
                                class="text-danger">*</span></label>
                        <input type="text" class="form-control money" id="startprice" name="startPrice" required>
                    </div>
                    <div class="mb-3">
                        <label for="reserverprice" class="form-label">æ‹è³£åº•åƒ¹</label>
                        <input type="text" class="form-control money" id="reserverprice" name="reserverPrice"
                               aria-describedby="reserverpriceHelp">
                        <div id="reserverpriceHelp" class="form-text">
                            å¦‚æœå‡ºåƒ¹æœªè¶…éæ‚¨æ‰€è¨­å®šçš„åº•åƒ¹ï¼Œç«¶æ¨™å°‡åœ¨æˆªæ­¢æ™‚è‡ªå‹•æµæ¨™
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="directprice" class="form-label">ç«‹å³çµæ¨™åƒ¹</label>
                        <input type="text" class="form-control money" id="directprice" name="directPrice"
                               aria-describedby="directpriceHelp">
                        <div id="directpriceHelp" class="form-text">
                            ä¸€æ—¦æœ‰äººå‡ºåƒ¹é”åˆ°æ‚¨æ‰€è¨­å®šçš„åƒ¹æ ¼ï¼Œç«¶æ¨™å°‡ç«‹å³çµæŸä¸¦æˆäº¤
                        </div>
                    </div>
                </div>

                <div class="mb-4 border p-4 rounded-3" style="background-color:white">
                    <h2 class="mb-4">å…¶ä»–è³‡è¨Š</h2>
                    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                        <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
                        <label class="btn btn-outline-primary" for="btnradio1">é¦¬ä¸Šä¸Šæ¶</label>

                        <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                        <label class="btn btn-outline-primary" for="btnradio2">é ç´„ä¸Šæ¶</label>
                    </div>
                </div>


                <button type="submit" class="btn btn-success btn-lg fixed-button rounded-3">ç¢ºå®šæå‡ºç”³è«‹</button>

            </form>
        </div>
    </div>
</div>

<!--bootstrap5 js-->
<script src="/TwoClothing/js/bootstrap5/popper.min.js"></script>
<script src="/TwoClothing/js/bootstrap5/bootstrap.min.js"></script>
<!--jQuery-->
<script src="/TwoClothing/js/jQuery/jquery-3.7.1.min.js"></script>
<!-- è™•ç†å•†å“é¡åˆ¥æ¨™ç±¤ -->
<script>
    $(document).ready(function () {
        const categorySelect = $("#categorySelect");
        const selectedCategoryId = $("#selectedCategoryId");
        const categoryModal = new bootstrap.Modal(document.getElementById("categoryModal"));
        const categoryTreeContainer = $("#categoryTree");
        // é»æ“Šæˆ–æ˜¯ç²å¾—ç„¦é»ï¼Œæ‰“é–‹æ¨¡æ…‹æ¡†
        categorySelect.on("focus click", function () {
            categoryModal.show();
        });
        // è¼¸å…¥è³‡æ–™çµæ§‹
        const categoryData = [
            {id: 2, name: "é¡åˆ¥1", parentId: 1},
            {id: 3, name: "é¡åˆ¥2", parentId: 1},
            {id: 4, name: "é¡åˆ¥3", parentId: 1},
            {id: 5, name: "å­é¡åˆ¥1.1", parentId: 2},
            {id: 6, name: "å­é¡åˆ¥1.2", parentId: 2},
            {id: 7, name: "å­é¡åˆ¥2.1", parentId: 3},
            {id: 8, name: "å­é¡åˆ¥2.2", parentId: 3},
            {id: 9, name: "å­é¡åˆ¥3.1", parentId: 4},
            {id: 10, name: "å­é¡åˆ¥2.2.1", parentId: 8},
            {id: 11, name: "å­é¡åˆ¥2.2.1.1", parentId: 10},
            {id: 12, name: "å­é¡åˆ¥2.2.1.1.1", parentId: 11},
            {id: 13, name: "å­é¡åˆ¥2.2.1.2", parentId: 10},
            {id: 14, name: "å­é¡åˆ¥2.2.1.1.1.1", parentId: 12},
        ];

        // æ ¹æ“šé¸é …çš„ID,æˆ–çš„å®Œæ•´çš„è·¯å¾‘
        function getFullCategoryName(categoryId, data) {
            const category = data.find((item) => item.id === categoryId);
            if (category.parentId !== 1) {
                const parentCategory = getFullCategoryName(category.parentId, data);
                return `${parentCategory} â½ ${category.name}`;
            }
            return category.name;
        }

        // æ ¹æ“šè¼¸å…¥çš„åƒæ•¸,å‹•æ…‹ç”Ÿæˆæ¨¹ç‹€çµæ§‹
        function buildCategoryTree(data, parentId) {
            const tree = document.createElement("ul");
            data.forEach((category) => {
                if (category.parentId === parentId) {
                    // æª¢æŸ¥è©²æ¨™ç±¤æ˜¯å¦æ˜¯è‘‰å­(ä¸å­˜åœ¨å­æ¨™ç±¤)
                    const isLeafCategory = !data.some((childCategory) => childCategory.parentId === category.id);

                    const listItem = document.createElement("li");
                    // æ·»åŠ é¸é …çš„åº•é‚Šè·é›¢
                    listItem.classList.add("mb-3");
                    listItem.textContent = category.name;
                    // æ›¿å¯é¸è·Ÿä¸å¯é¸çš„æ¨™ç±¤æ·»åŠ class(æ–¹ä¾¿cssæ”¹è®Šæ¨£å¼)
                    if (isLeafCategory) {
                        listItem.classList.add("selectable");
                    } else {
                        listItem.classList.add("non-selectable");
                    }
                    // ç¶å®šé»æ“Šäº‹ä»¶
                    listItem.addEventListener("click", function () {
                        // é‚„æœ‰å­æ¨™ç±¤çš„æ¨™ç±¤ä¸èƒ½è¢«é¸æ“‡
                        if (isLeafCategory) {
                            // éš±è—æ¡†å„²å­˜æ¨™ç±¤Id
                            selectedCategoryId.val(category.id);
                            // æ–‡æœ¬æ¡†é¡¯ç¤ºå®Œæ•´è·¯å¾‘å…§å®¹
                            categorySelect.val(getFullCategoryName(category.id, categoryData));
                            categoryModal.hide();
                        }
                    });
                    const childTree = buildCategoryTree(data, category.id);
                    if (childTree.childElementCount > 0) {
                        listItem.appendChild(childTree);
                    }
                    tree.appendChild(listItem);
                }
            });
            return tree;
        }

        // ä¸Ÿå…¥åƒæ•¸ æ·»åŠ å…§å®¹
        const categoryTree = buildCategoryTree(categoryData, 1);
        categoryTreeContainer.append(categoryTree);
    });
</script>

<!--åˆ¤æ–·åƒ¹æ ¼-->
<script>
    $(document).ready(function () {
        // å³æ™‚é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
        const moneyInputs = $('.money');
        moneyInputs.each(function () {
            const input = $(this);
            const errorMessage = $('<div class="error-message text-danger"></div>');
            input.parent().append(errorMessage);

            input.on('blur', function () {
                const value = input.val();
                if (value.trim() !== '' && !/^(0|[1-9]\d*)$/.test(value)) {
                    errorMessage.text('è«‹å¡«å¯«æ•´æ•¸æ•¸å­—');
                    input.addClass('is-invalid');
                } else {
                    errorMessage.text('');
                    input.removeClass('is-invalid');
                }
            });
        });
    });
</script>

<!--è¡¨å–®æäº¤æ™‚æª¢æŸ¥æ¬„ä½-->
<script>
    $('form').on('submit', function (e) {
        e.preventDefault();
        let firstInvalidInput = null;

        // æª¢æŸ¥é¡åˆ¥æ¨™ç±¤æœ‰ç„¡é¸æ“‡
        const categorySelect = $('#categorySelect');
        if (categorySelect.val().trim() === '') {
            firstInvalidInput = categorySelect;
        }

        // æª¢æŸ¥åƒ¹æ ¼æ¬„ä½æ˜¯å¦éŒ¯èª¤
        const priceInputs = $('.money');
        for (let i = 0; i < priceInputs.length; i++) {
            const input = $(priceInputs[i]);
            const value = input.val();
            if (value.trim() !== '' && !/^(0|[1-9]\d*)$/.test(value)) {
                if (firstInvalidInput === null) {
                    firstInvalidInput = input;
                }
            }
        }

        // æ ¹æ“šç¬¬ä¸€å€‹éŒ¯èª¤çš„æ¬„ä½alert
        if (firstInvalidInput !== null) {
            const errorMessage = firstInvalidInput === categorySelect
                ? 'è«‹é¸æ“‡å•†å“é¡åˆ¥æ¨™ç±¤'
                : 'éŠ·å”®è³‡è¨Šè£¡çš„åƒ¹æ ¼æ¬„ä½ï¼Œè«‹å¡«æœ‰æ•ˆæ•¸å­—(æ•´æ•¸)';
            alert(errorMessage);
            firstInvalidInput.focus();
            // æ»¾å‹•è¦–çª—åˆ°ç¬¬ä¸€å€‹éŒ¯èª¤æ¬„æœª
            const position = firstInvalidInput.offset().top - 100;
            $('html, body').animate({scrollTop: position}, 500);
        } else {
            this.submit();
        }
    });
</script>

</body>

</html>